# Механізм роботи з архетипами (агентами)

## Огляд

Архетипи (агенти) можуть створюватися та редагуватися через веб-інтерфейс. Всі текстові промпти автоматично конвертуються у файли в папці `prompts/`.

## Як це працює

### 1. Створення архетипу через веб-інтерфейс

1. Відкрийте "Налаштування агентів" через меню (☰ → Налаштування агентів)
2. Натисніть "+ Додати агента"
3. Заповніть форму:
   - **Ключ агента (ID)**: унікальний ідентифікатор (латинські літери, цифри, підкреслення)
   - **Назва**: відображається назва агента
   - **Опис**: короткий опис ролі
   - **Модель**: модель AI (gemini-2.5-flash, gemini-1.5-pro, тощо)
   - **Роль**: роль для режиму РАДА (creative_generator, critic, executor)
   - **Тип промпту**: виберіть "Файл" або "Текст"
     - **Файл**: вкажіть шлях до файлу (наприклад, `prompts/my_agent_base.txt`)
     - **Текст**: введіть текст промпту (буде автоматично створено файл)
   - **Додаткові промпти**: список файлів або текстових промптів
4. Натисніть "Зберегти конфігурацію"

### 2. Автоматичне створення файлів промптів

Коли ви зберігаєте архетип з текстовим промптом:

1. **Основний промпт**: 
   - Якщо ви ввели текст, він автоматично зберігається у файл `prompts/{archetype_key}_base.txt`
   - У `archetypes.yaml` зберігається посилання на файл: `prompt_file: prompts/{archetype_key}_base.txt`

2. **Додаткові промпти**:
   - Текстові промпти автоматично зберігаються у файли `prompts/{archetype_key}_additional_1.txt`, `prompts/{archetype_key}_additional_2.txt`, тощо
   - У `archetypes.yaml` зберігаються посилання на файли

### 3. Структура файлів

```
project/
├── archetypes.yaml          # Конфігурація архетипів (тільки посилання на файли)
├── prompts/                 # Папка з файлами промптів
│   ├── sofiya_base.txt
│   ├── sofiya_context_instructions.txt
│   ├── sofiya_response_style.txt
│   ├── lyra_base.txt
│   ├── maker_base.txt
│   ├── my_new_agent_base.txt        # Автоматично створений файл
│   └── my_new_agent_additional_1.txt # Автоматично створений файл
└── ...
```

### 4. Редагування архетипів

- **Через веб-інтерфейс**: відкрийте "Налаштування агентів", змініть потрібні поля, натисніть "Зберегти"
- **Через файли**: 
  - Редагуйте `archetypes.yaml` для зміни конфігурації (назва, модель, роль)
  - Редагуйте файли в `prompts/` для зміни промптів

### 5. Видалення архетипів

- **Через веб-інтерфейс**: натисніть "Видалити" на картці архетипу, потім "Зберегти конфігурацію"
- **Файли промптів**: файли залишаються в папці `prompts/` (можна видалити вручну, якщо потрібно)

## Приклад: Створення нового архетипу

### Через веб-інтерфейс:

1. Відкрийте "Налаштування агентів"
2. Натисніть "+ Додати агента"
3. Заповніть:
   - Ключ: `my_agent`
   - Назва: `Мій Агент`
   - Опис: `Тестовий агент`
   - Модель: `gemini-2.5-flash`
   - Роль: `creative_generator`
   - Тип промпту: `Текст`
   - Промпт: `Ти — тестовий агент...`
4. Натисніть "Зберегти конфігурацію"

### Результат:

- **Файл створено**: `prompts/my_agent_base.txt` з текстом промпту
- **archetypes.yaml оновлено**:
  ```yaml
  my_agent:
    name: Мій Агент
    description: Тестовий агент
    model_name: gemini-2.5-flash
    role: creative_generator
    prompt_file: prompts/my_agent_base.txt
  ```

## Важливо

1. **Всі промпти в файлах**: `archetypes.yaml` містить тільки посилання на файли, не тексти промптів
2. **Автоматична конвертація**: текстові промпти автоматично конвертуються у файли при збереженні
3. **Редагування файлів**: файли промптів можна редагувати вручну в папці `prompts/`
4. **Резервні копії**: перед збереженням створюється резервна копія `archetypes.yaml.backup`

## Видалення застарілих архетипів

Якщо ви видалили архетип (наприклад, "Мейкер" або "Ліра"):

1. Відкрийте "Налаштування агентів"
2. Натисніть "Видалити" на картці архетипу
3. Натисніть "Зберегти конфігурацію"
4. Файли промптів залишаються в `prompts/` (можна видалити вручну, якщо потрібно)

Файли, які можна видалити вручну (якщо архетип більше не використовується):
- `prompts/lyra_base.txt`
- `prompts/maker_base.txt`



